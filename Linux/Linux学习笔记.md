### Linux学习笔记

#### Linux系统目录结构

![树状目录结构](./res/linux-dir-struct.jpg "树状目录结构")

+ /bin

  `bin` 是`Binaries（二进制文件）`的缩写，这个目录存放着最经常用的命令。

+ /boot

  这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。

+ /dev

  `dev`是`Device（设备）`的缩写，该目录下存放的是Lunux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。

+ /etc

  `etc`是`Etcetera（等等）`的缩写，这个目录用来存放所有的系统管理所需的配置文件和子目录。

+ /home

  用户的主目录，在Linux中，每个用户都有一个子的的目录，一般该目录是以用户的账号命名的，如上图中的alice、bob和eve。

+ /lib

  `lib`是`Libary（库）`的缩写，这个目录存放着系统最基本的动态链接共享库。几乎所有的应用程序都需要用到这些共享库。

+ /lost+found

  这个目录一般是空的，当系统非法关机后，这里就存放了一些文件。

+ /media

  Linux系统会自动识别一些设备，例如U盘、光驱等等，当时别后，Linux会把识别的设备挂载到这个目录下。

+ /mnt

  系统提供该目录是为了让用户临时挂载别的文件系统，我们可以将光驱挂载到`/mnt/`目录下，然后进入该目录就可以查看光驱里的内容了。

+ /opt

  `opt`是`optional（可选）`的缩写，这是给主机额外安装软件所摆放的目录。比如安装一个MySql数据库就可以放在这个目录下。默认是空的。

+ /proc

  `proc`是`Processes（进程）`的缩写，`/proc`是一种伪文件系统（也就是虚拟文件系统），存储的是当前内核运行状态的一系列特殊文件，这个目录是一个虚拟目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。

+ /root

  该目录为系统管理员，也称作超级权限者的用户主目录。

+ /run

  是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件该被删掉或清除。如果你的系统上有`/var/run`目录，应该让它指向`run`。

+ /sbin

  `s`就是`Super User`的意思，是`Superuser Binaries（超级用户的二进制文件）`的缩写，这里存放的是系统管理员使用的系统管理程序。

+ /srv

  该目录存放一些服务启动之后需要提取的数据。

+ /sys

  这是 Linux2.6 内核的一个很大的变化。该目录下安装了 2.6 内核中新出现的一个文件系统 `sysfs `。

  `sysfs` 文件系统集成了下面3种文件系统的信息：针对进程信息的 `proc` 文件系统、针对设备的 `devfs` 文件系统以及针对伪终端的 `devpts` 文件系统。

  该文件系统是内核设备树的一个直观反映。

  当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。

+ /tmp

  `tmp`是`temporary（临时）`的缩写，这个目录是用来存放一些临时文件的。

+ /usr

  `usr`是`Unix Shared Resources（共享资源）`的缩写，这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下。类似于Windows的`Program Files`目录。

+ /usr/bin

  系统用户使用的应用程序。

+ /usr/sbin

  超级用户使用的比较高级的管理程序和系统守护进程。

+ /usr/src

  内核源码默认的放置目录。

+ /var

  `var`是`variable（变量）`的缩写，这个目录下存放着不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。

####  Linux文件与目录管理

##### 处理目录的常用命令

+ ls (list files) 列出目录及文件名

  选项与参数：

  + -a ：全部的文件，连同隐藏文件（开头为`.`的文件）一起列出来
  + -d ：仅列出目录本身，而不是列出目录内的文件数据
  + -l：长数据串列出，包含文件的属性与权限等

+ cd (change directory) 切换目录

  `cd [相对路径或绝对路径]`

+ pwd (print work directory) 显示目前目录

+ mkdir (make directory) 创建一个新的目录

  `mkdir [-mp] 目录名称`

  选项与参数：

  + -m：配置文件权限
  + -p：同时将所需的目录（上级目录）递归创建

+ rmdir (remove directory) 删除一个空的目录

  `rmdir [-p] 目录名称`

  选项与参数：

  + -p：连同上一级目录也一起删除，需要保证目标目录的上一级目录中没有其他文件或目录

+ cp (copy file) 复制文件或目录

  `cp 来源 目的`

  选项与参数：

  + -a：相当于`-pdr`
  + -d：
  + -f：强制（force），若目标文件已存在且无法开启，则移除后在尝试一次
  + -i：若目标档已存在，在覆盖时会先询问
  + -l：
  + -p：连同文件的属性一起复制过去，而非使用默认属性
  + -r：递归持续复制，用于目录的复制行为
  + -s：
  + -u：若目标比来源旧才升级

+ rm (remove) 删除文件或目录

  `rm [-fir] 文件或目录`

  选项与参数：

  + -f：强制，忽略不存在的文件，不会出现警告信息
  + -i：互动模式，在删除前会询问使用者是否进行动作
  + -r：递归删除，常用于删除目录

+ mv (move) 移动文件或目录，或修改文件与目录名

  `mv [-fiu] 来源 目的`

  选项与参数：

  + -f：强制，如果目标已存在，不会询问而直接覆盖
  + -i：若目标文件已存在，会询问是否覆盖
  + -u：若目标文件已存在，且来源比较新才会升级（update）

##### Linux文件内容查看

+ cat 由第一行开始显示文件内容

  选项与参数：

  + -A：相当于`-vET`
  + -b：列出行号，仅针对非空白行显示，空白行不显示行号
  + -E：将结尾的断行字节`$`显示出来
  + -n：列出行号，空白行也有行号
  + -T：将`Tab`键以`^|`显示出来
  + -v：列出一些看不到的特殊字符

+ tac 从最后一行开始显示（cat倒着写）

+ more 一页一页显示文件内容

  在显示过程中，可以按几个键：

  + 空格（Space）：向下翻一页
  + 回车（Enter）：向下翻一行
  + /<字符串>：向下搜索字符串
  + f：向下翻页
  + :f：显示出文档名以及目前显示的行数
  + q：退出
  + b：往回翻页

+ less 与more类似，但可以往前翻

  除了more的按键命令，还有：

  + PageDown：向下翻页
  + PageUp：向上翻页
  + ?<字符串>：向上搜索
  + n：重复前一个搜索
  + N：反向前一个搜索

+ head 只看头几行

  `head [-n number] 文件`

  选项与参数：

  + -n 后面接数字，代表显示几行

+ tail 只看最后几行

  `tail [-n number] 文件`

  选项与参数：

  + -n：后面接数字，代表显示几行
  + -f：表示持续侦测后面所接的文件，刷新文件内容，`ctrl-c`结束

#### Linux进程管理

##### 进程管理常用命令

+ ps 列出系统中运行的进程，包括进程号、命令、CPU使用量、内存使用量等。

  选项与参数：

  + -A：列出所有进程
  + -au：显示较详细的资讯
  + -aux：显示包含其他使用者的进程
  + -ef | grep 进程关键字：查找指定进程格式
  + -u 用户：显示指定所属用户的进程

  au(x)输出格式：

  `USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND`

  + VSZ：占用虚拟内存大小
  + RSS：占用内存大小
  + TTY：终端的此哟啊装置号码
  + STAT：该进程的状态
    + D：无法中断的休眠状态（通常IO的进程）
    + R：正在执行中
    + S：睡眠状态
    + T：暂停执行
    + Z：僵尸进程
    + W：没有足够内存页可分配
    + <：高优先序的进程
    + N：低优先序的进程
    + L：有内存分页分配并锁在内存中
  + START：进程开始时间
  + TIME：进程执行时间
  + COMMAND：所执行的指令

+ pstree 以可视化方式显示进程，通过显示进程的树状图来展示进程间关系

+ top 是一个更加有用的命令，可以监视系统中不同的进程所使用的资源。它提供实时的系统状态信息，显示进程的数据包括PID、进程属主、优先级、%CPU、%MEM等。top命令是Linux下常用的性能分析工具，能够实时显示系统中各个进程的资源占用情况，类似于Windows的任务管理器

  选项与参数：

  + -d：指定每两次屏幕刷新的时间间隔
  + -p：通过指定监控进程ID来仅仅监控某个进程状态
  + -q：使top没有任何延迟地进行刷新
  + -S：指定累计模式
  + -s：使top命令在安全模式下运行，这将消除交互命令所带来的潜在风险
  + -i：使top命令不显示任何限制的或僵死进程
  + -c：显示整个命令行而不只是显示命令名

+ htop 与top很类似，但是htop是交互式的文本模式的进程查看器

+ nice 通过nice命令，用户可以设置和改变进程的优先级。提高一个进程的优先级，内核会分配更多CPU时间片给这个进程。默认情况下，进程以0的优先级启动。

  `nice <优先级> <进程名> `

+ renice 与nice相似，使用这个命令可以改变正在运行的进程优先级。注意，用户只能改变属于他们自己的进程的优先级

+ kill 这个命令用于发送信号来结束进程。如果一个进程没有响应杀死命令，也许就需要强制杀手，使用`-9`参数来执行。

+ ulimit 该命令用于控制资源系统在shell和进程上的分配量

+ w 提供当前登录用户及其正在执行的进程的信息。显示信息头包含信息，如当前时间、系统运行时长、登录用户总数、过去1，5，15分钟内的负载均衡数

+ pgrep 的意思是"进程号全局正则匹配输出"。该命令扫描当前运行进程，然后按照命令匹配条件列出匹配结果到标准输出。对于通过名字检索进程号是很有用

+ fg，bg 有时，命令需要很长时间才能执行完成，对于这种情况，我们使用`bg`命令可以将任务放在后台执行，而用`fg`可以调到前台来使用。我们可以通过`&`在后台启动一个程序

  `find . -name *iso > /tmp/res.txt &`

+ ipcs 命令报告进程间通信设施状态。（共享内存，信号量和消息队列）

